webpackJsonp([4],{"9smv":function(e,t,a){e.exports=a.p+"static/img/maijiaxinxi.66cb415.png"},Br03:function(e,t){},JC9h:function(e,t,a){e.exports=a.p+"static/img/logo.0b5d679.jpg"},KkE3:function(e,t){},MTUy:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("//Fk"),o=a.n(s),r=a("7+uW"),i=a("rflr"),n=a.n(i),l=(a("t0aP"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-footer",{attrs:{id:"footer"}},[t("p",[this._v("物品交换网站Echange QDU版权所有"),t("br"),this._v("\n    Copyright © Element UI | Vue.js | Django rest framework")])])},staticRenderFns:[]});function c(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var u={name:"App",components:{MyFooter:a("VU/8")({name:"MyFooter"},l,!1,function(e){a("h5ZX")},"data-v-bbc814bc",null).exports},filters:{timeFormat:c}},d={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view",{staticClass:"header",attrs:{name:"header"}}),this._v(" "),t("router-view",{staticClass:"content"}),this._v(" "),t("MyFooter")],1)},staticRenderFns:[]};var m=a("VU/8")(u,d,!1,function(e){a("qVfH")},null,null).exports,p=a("/ocq"),v={data:function(){return{}},mounted:function(){console.log("获取pic基本路径 ",this.$store.state.base_url),console.log("获取mount中store中userinfo ",this.$store.state.userinfo)},name:"myHeaderTop",methods:{goPersonal:function(){},goLogin:function(){this.$router.push("/login")},goRegister:function(){this.$router.push("/register")},goLogout:function(){var e=this;console.log("登出中"),this.$confirm("确定要登出吗，亲？","登出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){localStorage.removeItem("Token"),e.$store.dispatch("setToken",null),e.$router.push("/login"),e.myusername="",e.$message({type:"success",message:"登出成功！"})}).catch(function(){e.$message({type:"info",message:"取消登出"})})}},computed:{islogin:function(){return!!this.$store.state.token},myusername:{get:function(){return localStorage.getItem("username")},set:function(e){console.log(e)}}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header-top"},[a("el-row",{staticClass:"header-row"},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("a",{staticStyle:{float:"left"}},[e._v("欢迎来到青岛大学Echange Site")])])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple-light"})]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"})]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple-light"})]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"})]),e._v(" "),a("el-col",{staticClass:"right-box",attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("a",{directives:[{name:"show",rawName:"v-show",value:!e.islogin,expression:"!islogin"}],on:{click:e.goRegister}},[e._v("注册 | ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:!e.islogin,expression:"!islogin"}],on:{click:e.goLogin}},[e._v("登陆")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.islogin,expression:"islogin"}],on:{click:e.goPersonal}},[e._v("Welcome "+e._s(e.myusername)+" | ")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:e.islogin,expression:"islogin"}],on:{click:e.goLogout}},[e._v("登出")])])])],1)],1)},staticRenderFns:[]};var g={data:function(){return{input:"",form:{search:""}}},name:"myHeaderMiddle",methods:{onSubmit:function(){}},computed:{getuserpic:function(){return!1===this.checkuserpic?"":this.$store.state.base_url+this.$store.state.userinfo.picture},checkuserpic:function(){var e=this.$store.state.userinfo;return!(!e||void 0===e)}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("div",{staticClass:"grid-content bg-purple"},[s("img",{attrs:{src:a("JC9h"),width:"250px"}})])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"grid-content bg-purple"})]),e._v(" "),s("el-col",{attrs:{span:12}},[s("div",{staticClass:"grid-content bg-purple right-middle"},[e.checkuserpic?s("div",[s("img",{staticClass:"user_img1",attrs:{src:e.getuserpic,width:"80px",height:"80px"}})]):e._e(),e._v(" "),s("el-form",{staticClass:"form-inline",attrs:{inline:!0},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[s("el-form-item",{attrs:{label:"",prop:"search"}},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"搜索内容",clearable:""},model:{value:e.form.search,callback:function(t){e.$set(e.form,"search",t)},expression:"form.search"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-zoom-in",round:""},on:{click:e.onSubmit}},[e._v("站内搜索")])],1)],1)],1)])],1)},staticRenderFns:[]};var _={name:"MyHeader",data:function(){return{activeIndex:this.$route.name}},computed:{activeIndexHandler:function(){return this.$route.path.split("/")[1]}},methods:{handleClick:function(e,t){console.log(e,t)}},components:{myHeaderTop:a("VU/8")(v,f,!1,function(e){a("QJz+")},"data-v-07e578b8",null).exports,myHeaderMiddle:a("VU/8")(g,h,!1,function(e){a("KkE3")},null,null).exports}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header-main"},[a("myHeaderTop"),e._v(" "),a("myHeaderMiddle"),e._v(" "),a("br"),e._v(" "),a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndexHandler,mode:"horizontal",router:!0}},[a("el-menu-item",{attrs:{route:{name:"home"},index:"home"}},[e._v("首页")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"goods"},index:"goods"}},[e._v("全部商品")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"publish"},index:"publish"}},[e._v("我要发布")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personal"},index:"personal"}},[e._v("个人中心")])],1)],1)},staticRenderFns:[]};var w=a("VU/8")(_,b,!1,function(e){a("eMli")},"data-v-04617105",null).exports,x={data:function(){return{currentDate:new Date,goods_list:[],base_url:this.$store.state.base_url}},name:"home",mounted:function(){var e=this;console.log("hello"),this.$axios.get("/goods/goods").then(function(t){e.goods_list=t.data,console.log(e.base_url+e.goods_list[0].picture)})},filters:{date:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},methods:{dumpDetail:function(e){this.$router.push("/goods/"+e)}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-carousel",{attrs:{"indicator-position":"outside"}},e._l(4,function(t){return a("el-carousel-item",{key:t},[a("h3",[e._v(e._s(t))])])}),1),e._v(" "),a("br"),a("br"),e._v(" "),a("div",{staticClass:"my-index-box"},e._l(e.goods_list,function(t){return a("el-col",{key:t.id,staticClass:"goods-card",attrs:{span:8,offset:t.id>0?2:0}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("img",{staticClass:"image",attrs:{src:e.base_url+t.picture[0]}}),e._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("span",[e._v(e._s(t.title))]),e._v(" "),a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"},[e._v(e._s(e._f("date")(t.create_time)))]),e._v(" "),a("br"),a("br"),e._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(a){return e.dumpDetail(t.id)}}},[e._v("查看详情")])],1)])])],1)}),1)],1)},staticRenderFns:[]};var $=a("VU/8")(x,y,!1,function(e){a("gQV5")},"data-v-29f6896d",null).exports,C=a("BO1k"),k=a.n(C),S={name:"goods",data:function(){return{tableData:[],base_url:this.$store.state.base_url,pagesize:5,currentPage:1,typeFilter:[],typeObject:{},total:0}},created:function(){var e=this,t=this;t.$axios.get("/api/all_goods_type").then(function(a){var s=a.data.data,o=[],r=!0,i=!1,n=void 0;try{for(var l,c=k()(s);!(r=(l=c.next()).done);r=!0){var u=l.value;o.push({value:u.value,text:u.label}),e.typeObject[u.value]=u.label}}catch(e){i=!0,n=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw n}}t.typeFilter=o})},methods:{handleCurrentChange:function(e){this.currentPage=e},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1},handleRowClick:function(e,t,a){console.log(e),this.$router.push("/goods/"+e.id)},filterHandler:function(e,t,a){return console.log(e),t.type===this.typeObject[e]},filterChange:function(e){e.type}},computed:{},filters:{timeFormat:c},mounted:function(){var e=this;this.$axios.get("/goods_api/goods").then(function(t){e.tableData=t.data,e.total=t.data.length})},components:{}},U={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",["goods"===this.$route.name?a("div",{staticClass:"goods-index-box"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("全部商品")])],1),e._v(" "),a("br"),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize)},on:{"row-click":e.handleRowClick,"filter-change":e.filterChange}},[a("el-table-column",{attrs:{prop:"id",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type","column-key":"type",label:"筛选种类",filters:e.typeFilter,"filter-method":e.filterHandler,width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:e.base_url+t.row.picture[0],alt:""}})]}}],null,!1,1249957469)}),e._v(" "),a("el-table-column",{attrs:{prop:"title",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          品名: "+e._s(t.row.title)),a("br"),e._v("\n          卖家: "+e._s(t.row.publisher.username)+"\n        ")]}}],null,!1,3316446262)}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("timeFormat")(t.row.create_time))),a("br")]}}],null,!1,3704804)}),e._v(" "),a("el-table-column",{attrs:{prop:"want"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          估价："),a("span",{staticStyle:{color:"#F56C6C"}},[e._v("¥"),a("span",{staticStyle:{color:"#F56C6C","font-size":"20px"}},[e._v(e._s(t.row.price))])]),a("br"),e._v("\n          想换: "+e._s(t.row.want)+"\n        ")]}}],null,!1,3672891410)}),e._v(" "),a("el-table-column",{attrs:{prop:"publisher.address"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          卖家位置："),a("br"),e._v("\n          "+e._s(t.row.publisher.address)+"\n        ")]}}],null,!1,1130789893)})],1),e._v(" "),a("div",{staticClass:"my-pagination"},[a("br"),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pagesize,layout:"prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1):e._e(),e._v(" "),a("keep-alive",[a("router-view",{key:e.$route.fullPath})],1)],1)},staticRenderFns:[]};var F=a("VU/8")(S,U,!1,function(e){a("MTUy")},"data-v-a5aaa2ec",null).exports,T={name:"Login",data:function(){return{form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"用户名要在五个字符以上",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{onSubmit:function(){var e=this,t=this;this.$refs.form.validate(function(a){if(!a)return t.$message.error("submit not valid"),!1;t.$axios.post("user/login",e.form).then(function(a){var s=a.data.code,o=a.data.flag;console.log(s,o),200===s&&"success"===o?t.$axios.post("/api-token-auth",e.form).then(function(a){var s=a.data.token;e.$store.dispatch("setToken",s),localStorage.setItem("Token",s),localStorage.setItem("username",e.form.username),e.$notify({title:"登录成功",message:"欢迎你,恭喜你登陆成功,尊敬的用户"+t.form.username,type:"success"}),t.$router.push("/home")}).catch(function(e){t.$message.error(e)}):(t.$message.error("登陆不成功，密码错误"),localStorage.removeItem("Token"))}).catch(function(e){t.$message.error(e)})})},resetForm:function(){this.$refs.form.resetFields()}}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-div"},[a("h1",[e._v("登陆EChange")]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("登陆")])],1)],1)],1)},staticRenderFns:[]};var I=a("VU/8")(T,D,!1,function(e){a("Br03")},"data-v-7af4fc4c",null).exports,E={name:"Register",data:function(){return{form:{username:"",passwd:"",confpasswd:"",phone:"",email:"",sex:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"用户名要在五个字符以上",trigger:"blur"}],passwd:[{required:!0,message:"请输入密码",trigger:"blur"}],confpasswd:[{required:!0,message:"请输入确认密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"blur"}]}}},methods:{onSubmit:function(){var e=this,t=this;this.$refs.form.validate(function(a){if(!a)return t.$message.error("submit not valid"),console.log("submit not valid"),!1;t.$axios.request({url:"/user/register",method:"post",data:e.form}).then(function(a){var s=a.data.code;200===s?(e.$notify({title:"注册成功",message:"恭喜你注册成功,成为小站的用户，去登陆吧",type:"success"}),e.$router.push("/login")):t.$message.error("注册失败，代码:"+s+" 错误信息:"+a.data.error)})})},resetForm:function(){this.$refs.form.resetFields()}}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-div"},[a("h1",[e._v("注册EChange会员")]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"passwd"}},[a("el-input",{attrs:{"show-password":""},model:{value:e.form.passwd,callback:function(t){e.$set(e.form,"passwd",t)},expression:"form.passwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"confpasswd"}},[a("el-input",{attrs:{"show-password":""},model:{value:e.form.confpasswd,callback:function(t){e.$set(e.form,"confpasswd",t)},expression:"form.confpasswd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("el-radio",{attrs:{label:"1"}},[e._v("男")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("女")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即注册")]),e._v(" "),a("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")(E,B,!1,function(e){a("s2S0")},"data-v-4ef9303c",null).exports,R={name:"Publish",data:function(){return{username:localStorage.getItem("username"),options:[],active:0,dialogImageUrl:"",dialogVisible:!1,myTitleMsg:"",baseUrl:this.$store.state.base_url,form:{title:"",type:"",price:"",brand:"",condition:90,picture:"",detail:"",want:""}}},computed:{generateTable:function(){var e={},t=!0,a=!1,s=void 0;try{for(var o,r=k()(this.options);!(t=(o=r.next()).done);t=!0){var i=o.value;e[i.value]=i.label}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return[{key:"物品简介",value:this.form.title},{key:"物品种类",value:e[this.form.type]},{key:"价格",value:this.form.price},{key:"品牌",value:this.form.brand},{key:"新旧程度",value:this.form.condition+"成新"},{key:"详细信息",value:this.form.detail},{key:"想换的",value:this.form.want}]},titleMsg:function(){return 0===this.active?"填写基本信息":1===this.active?"描述一下你的宝贝，并说一下想要些什么":"check一下信息，并发布吧"}},mounted:function(){var e=this;e.$axios.get("/api/all_goods_type").then(function(t){e.options=t.data.data,console.log(e.options)})},methods:{submitForm:function(){var e=this,t=this;this.$confirm("确定信息无误提交吗，亲？","发布确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/goods/goods",e.form).then(function(t){"success"===t.data.flag?(e.$notify.success({title:"发布成功",message:"发布商品成功"}),e.$router.push("/home")):e.$notify.error({title:"发布失败",message:t.data.error})}).catch(function(t){e.$notify.error({title:"发布失败",message:"发布商品失败"}),console.log(t)})}).catch(function(){e.$message({type:"info",message:"取消发布"})})},last:function(){this.active--},next:function(){if(0===this.active){var e=this.form;e.title&&e.type&&e.price&&e.brand&&e.picture?this.active++:this.$message.warning("请填写必填项")}else if(1===this.active){var t=this.form;t.detail&&t.want?this.active++:this.$message.warning("请填写必填项")}},handleRemove:function(e,t){var a=e.response.url+"$$$",s=this.form.picture;s=s.replace(a,""),this.form.picture=s,this.$message.info({message:"图片删除成功"});var o=this.$qs.stringify({url:e.response.url});this.$axios.post("/api/del_pic",o).then(function(e){}).catch(function(e){console.log(e)})},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleBeforeUpload:function(e){console.log("before"),"image/png"!==e.type&&"image/gif"!==e.type&&"image/jpg"!==e.type&&"image/jpeg"!==e.type&&this.$message.warning({title:"警告",message:"请上传格式为image/png, image/gif, image/jpg, image/jpeg的图片"}),e.size/1024/1024/2>2&&this.$message.warning({title:"警告",message:"图片大小必须小于2M"})},handleErrorUpload:function(e,t,a){this.$notify.error({title:"错误",message:"文件上传失败"}),console.log(e)},handleSuccessUpload:function(e,t,a){this.form.picture+=e.url+"$$$",this.$message.success({title:"上传成功",message:"图片上传成功"})}},components:{}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("我要发布")])],1),e._v(" "),a("br"),e._v(" "),a("el-steps",{attrs:{active:e.active,"finish-status":"success"}},[a("el-step",{attrs:{title:"填写简单介绍"}}),e._v(" "),a("el-step",{attrs:{title:"填写详细信息"}}),e._v(" "),a("el-step",{attrs:{title:"确认信息并提交"}})],1),e._v(" "),a("br"),e._v(" "),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],staticClass:"info-box",attrs:{type:"info"}},[a("h1",[e._v("Hi "+e._s(e.username)+",有什么闲置物品想换的吗，来这里发布吧～")])]),e._v(" "),a("h1",[e._v(e._s(e.titleMsg))]),e._v(" "),a("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.form}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"物品名称(标题)",required:""}},[a("el-input",{attrs:{placeholder:"物品简介(50字以内)"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"物品种类",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"你的估价(RMB)",required:""}},[a("el-input",{attrs:{type:"number",placeholder:"输入您的估价"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"品牌",required:""}},[a("el-input",{attrs:{placeholder:"输入商品的品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"新旧成色",required:""}},[a("el-slider",{attrs:{step:5,min:30,"show-input":""},model:{value:e.form.condition,callback:function(t){e.$set(e.form,"condition",t)},expression:"form.condition"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.active,expression:"active === 0"}],attrs:{label:"传几张图片吧",required:""}},[a("el-upload",{attrs:{action:"http://localhost:8000/api/upload_pic","list-type":"picture-card","before-upload":e.handleBeforeUpload,"on-success":e.handleSuccessUpload,"on-error":e.handleErrorUpload,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"图片路径"}},[a("el-input",{attrs:{placeholder:"图片路径"},model:{value:e.form.picture,callback:function(t){e.$set(e.form,"picture",t)},expression:"form.picture"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],attrs:{label:"详细描述",required:""}},[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入您的宝贝的详细内容"},model:{value:e.form.detail,callback:function(t){e.$set(e.form,"detail",t)},expression:"form.detail"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active === 1"}],attrs:{label:"期望换的物品",required:""}},[a("el-input",{attrs:{type:"textarea",rows:5,placeholder:"写一写你想换些啥"},model:{value:e.form.want,callback:function(t){e.$set(e.form,"want",t)},expression:"form.want"}})],1)],1),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],staticStyle:{width:"100%"},attrs:{data:e.generateTable,stripe:""}},[a("el-table-column",{attrs:{prop:"key",label:"属性"}}),e._v(" "),a("el-table-column",{attrs:{prop:"value",label:"值"}})],1),e._v(" "),a("el-carousel",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],attrs:{interval:4e3,type:"card",height:"200px"}},e._l(this.form.picture.split("$$$").filter(function(e){return""!=e}),function(t){return a("el-carousel-item",{key:t},[a("img",{attrs:{src:e.baseUrl+t,width:"100%"}})])}),1),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.active,expression:"active != 0"}],staticStyle:{"margin-top":"12px"},on:{click:e.last}},[e._v("上一步")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=e.active,expression:"active != 2"}],staticStyle:{"margin-top":"12px"},on:{click:e.next}},[e._v("下一步")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.active,expression:"active == 2"}],staticStyle:{"margin-top":"12px"},on:{click:e.submitForm}},[e._v("提交")])],1)},staticRenderFns:[]};var q=a("VU/8")(R,V,!1,function(e){a("pCJT")},"data-v-34c1d318",null).exports,M={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("个人中心")])],1),e._v(" "),a("h3",[e._v("Welcome，亲爱的Echange用户 "+e._s(e.getusername))]),e._v(" "),e._m(0),e._v(" "),a("h4",[e._v("这里是个人中心，点击左侧的菜单栏可以修改您的信息，或者管理你的订单噢")])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",[t("i",{staticClass:"el-icon-loading"}),t("i",{staticClass:"el-icon-loading"}),t("i",{staticClass:"el-icon-loading"})])}]};var P={data:function(){return{}},methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)},goPersonal:function(){this.$router.push("/personal")}},mounted:function(){},computed:{getuserpic:function(){return this.$store.state.userinfo?(console.log("picaddress :"+this.$store.state.userinfo),this.$store.state.base_url+this.$store.state.userinfo.picture):""},getusername:function(){return this.$store.state.userinfo?this.$store.state.userinfo.username:""}},components:{myBase:a("VU/8")({data:function(){return{}},computed:{getusername:function(){return this.$store.state.userinfo?this.$store.state.userinfo.username:""}},components:{}},M,!1,function(e){a("TDhp")},"data-v-40502789",null).exports}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("el-container",{staticClass:"main-container"},[a("el-aside",{attrs:{width:"220px"}},[a("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":this.$route.name,router:!0,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{open:e.handleOpen,close:e.handleClose}},[a("img",{staticClass:"user_img",attrs:{src:e.getuserpic,width:"100px",height:"100px"},on:{click:e.goPersonal}}),e._v(" "),a("p",{staticClass:"personal-name"},[e._v("hello "+e._s(e.getusername))]),e._v(" "),a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-info"}),e._v(" "),a("span",[e._v("个人信息")])]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personalImage"},index:"image"}},[e._v("修改头像")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personalInfo"},index:"info"}},[e._v("基本资料")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personalPassword"},index:"password"}},[e._v("修改密码")])],2),e._v(" "),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-menu"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("换物中心")])]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personalImage"},index:"image"}},[e._v("我的发布")]),e._v(" "),a("el-menu-item",{attrs:{route:{name:"personalInfo"},index:"info"}},[e._v("我想换的")])],2),e._v(" "),a("el-menu-item",{attrs:{index:"3",disabled:""}},[a("i",{staticClass:"el-icon-document"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("导航三")])]),e._v(" "),a("el-menu-item",{attrs:{index:"4"}},[a("i",{staticClass:"el-icon-close"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("退出登陆")])])],1)],1),e._v(" "),a("el-main",["personal"===this.$route.name?a("myBase"):e._e(),e._v(" "),a("router-view",{attrs:{name:"personal"}})],1)],1)],1)},staticRenderFns:[]};var H=a("VU/8")(P,z,!1,function(e){a("fQBZ")},"data-v-a3eaf642",null).exports,L={data:function(){return{goodsDetail:{brand:"python",condition:99,create_time:"2019-04-18T21:04:27.302906+08:00",detail:"知识是无价的",id:1,picture:["img/timg.jpg"],price:1e6,publisher:{id:3,username:"gople",email:"lyf9708@163.com"},title:"python知识",type:"其他",want:"asdfsad"},form:{msg:"",goods_id:0}}},created:function(){var e=this;this.good_id=this.$route.params.id,this.$axios.get("/goods_api/goods",{params:{id:this.$route.params.id}}).then(function(t){e.goodsDetail=t.data[0],console.log(e.goodsDetail)}).catch(function(e){console.log(e)})},mounted:function(){var e=this;this.$axios.get("/api/user_goods_check",{params:{id:this.$route.params.id}}).then(function(t){"success"!==t.data.flag&&(e.$notify.error({title:"您已经提交过了",message:t.data.msg}),e.$router.push("/home"))}).catch(function(e){console.log(e)})},components:{},computed:{getImgBaseUrl:function(){return this.$store.state.base_url}},methods:{goWant:function(){var e=this;this.$confirm("确定信息无误提交吗，亲？","发布确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.form.goods_id=e.goodsDetail.id,e.$axios.post("/goods_api/order",e.form).then(function(t){"success"===t.data.flag?(e.$notify.success({title:"申请成功",message:"申请交易意向成功"}),e.$router.push("/personal")):e.$notify.error({title:"申请失败",message:t.data.error})}).catch(function(t){e.$notify.error({title:"发布失败",message:"发布申请失败"}),console.log(t)})}).catch(function(){e.$message({type:"info",message:"取消发布"})})},goBack:function(){this.$router.back(-1)}}},j={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("全部商品")]),e._v(" "),a("el-breadcrumb-item",[e._v("交换确认")])],1),e._v(" "),a("h3",[e._v("交换意向确认页面")]),e._v(" "),a("hr",{staticStyle:{"background-color":"#d3dce6",height:"1px",border:"none"}}),e._v("\n      \n  卖家："+e._s(e.goodsDetail.publisher.username)+"      \n              \n  预计交易地点："+e._s(e.goodsDetail.publisher.address)+"\n  "),a("div",{staticClass:"inner-info"},[a("el-row",{staticStyle:{height:"100%"}},[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content bg-purple"},[a("img",{attrs:{src:e.getImgBaseUrl+e.goodsDetail.picture[0],width:"130px"}})])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("\n          品名："+e._s(e.goodsDetail.title)),a("br"),e._v("\n          品牌："+e._s(e.goodsDetail.brand)),a("br"),e._v("\n          成色："+e._s(e.goodsDetail.condition)),a("br"),e._v("\n          预计交易地点："+e._s(e.goodsDetail.publisher.address)+"\n        ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content price bg-purple"},[e._v("\n          预估单价："),a("span",{staticStyle:{color:"#F56C6C"}},[e._v("¥"),a("span",{staticStyle:{color:"#F56C6C","font-size":"20px"}},[e._v(e._s(e.goodsDetail.price))])])])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content msg bg-purple-light"},[e._v("\n          给卖家留言:"),a("br"),e._v(" "),a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"选填"},model:{value:e.form.msg,callback:function(t){e.$set(e.form,"msg",t)},expression:"form.msg"}})],1)])],1)],1),e._v(" "),a("hr",{staticStyle:{"background-color":"#d3dce6",height:"1px",border:"none"}}),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.goWant}},[e._v("确认无误，提交意向")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.goBack}},[e._v("我再想想")])],1)},staticRenderFns:[]};var O=a("VU/8")(L,j,!1,function(e){a("xtiH")},"data-v-3c767778",null).exports,W={data:function(){return{good_id:"",good_detail:{},activeName:"first",similar_goods:{},isCollected:!1,isOrdered:!1}},methods:{handleClick:function(e,t){console.log(e,t)},goAnother:function(e){this.$router.replace("/goods/"+e)},initData:function(){console.log("路由发送变化doing...")},goWant:function(){this.$router.push("/goods/"+this.$route.params.id+"/want")},goCollection:function(){var e=this,t=this;this.$axios.post("/goods_api/collection",{params:{id:this.$route.params.id}}).then(function(a){t.$message.success(a.data.msg),"收藏成功"===a.data.msg?e.isCollected=!0:e.isCollected=!1}).catch(function(e){console.log(e)})}},watch:{$route:"initData"},filters:{timeFormat:c},created:function(){var e=this;this.initData(),this.$axios.get("/api/similar_goods",{params:{id:this.$route.params.id}}).then(function(t){e.similar_goods=t.data}),this.$axios.get("/goods_api/collection",{params:{id:this.$route.params.id}}).then(function(t){e.isCollected=t.data.msg}),this.$axios.get("/api/user_goods_check",{params:{id:this.$route.params.id}}).then(function(t){"fail"===t.data.flag&&(e.isOrdered=!0)})},mounted:function(){var e=this;window.scroll(0,0),this.good_id=this.$route.params.id,this.$axios.get("/goods_api/goods",{params:{id:this.$route.params.id}}).then(function(t){e.good_detail=t.data[0]}).catch(function(e){console.log(e)})},computed:{getImgBaseUrl:function(){return this.$store.state.base_url}},components:{}},A={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),s("el-breadcrumb-item",[e._v("全部商品")]),e._v(" "),s("el-breadcrumb-item",[e._v("详细信息")])],1),e._v(" "),s("br"),e._v(" "),s("el-row",[s("el-col",{attrs:{span:8}},[s("div",{staticClass:"grid-content bg-purple"},[s("div",{staticClass:"block"},[s("el-carousel",{attrs:{trigger:"click","indicator-position":"outside"}},e._l(e.good_detail.picture,function(t){return s("el-carousel-item",{key:t,staticClass:"img-father"},[s("img",{attrs:{src:e.getImgBaseUrl+t,width:"100%"}})])}),1)],1)])]),e._v(" "),s("el-col",{attrs:{span:10}},[s("div",{staticClass:"grid-content bg-purple-light content-top-middle"},[s("h4",[e._v("  "+e._s(e.good_detail.title))]),e._v(" "),s("el-alert",{attrs:{type:"error",closable:!1}},[e._v("\n          预估换物价：¥ "),s("span",{staticStyle:{"font-size":"28px"}},[e._v(e._s(e.good_detail.price))])]),e._v(" "),s("el-alert",{attrs:{type:"info",closable:!1}},[e._v("\n          卖家想换："+e._s(e.good_detail.want)+"\n        ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("商品编号:     \n          "+e._s(e.good_detail.id)+"\n        ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("品       牌:\n              \n          "+e._s(e.good_detail.brand)+"\n        ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("成       色:\n              \n          "+e._s(e.good_detail.condition)+"成新\n        ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("类       型:\n              \n          "+e._s(e.good_detail.type)+"\n        ")]),e._v(" "),s("hr"),e._v(" "),s("p",{staticClass:"small-text"},[e._v("发布时间:\n              \n          "+e._s(e._f("timeFormat")(e.good_detail.create_time))+"\n        ")]),e._v(" "),e.isOrdered?e._e():s("el-button",{attrs:{type:"primary",plain:""},on:{click:e.goWant}},[e._v("我想要")]),e._v(" "),e.isOrdered?s("el-button",{attrs:{type:"primary",disabled:"",plain:""}},[e._v("您已申请")]):e._e(),e._v(" "),e.isCollected?e._e():s("el-button",{attrs:{type:"warning"},on:{click:e.goCollection}},[e._v("\n          收藏")]),e._v(" "),e.isCollected?s("el-button",{attrs:{type:"warning"},on:{click:e.goCollection}},[e._v("\n          取消收藏")]):e._e()],1)]),e._v(" "),e.good_detail.publisher?s("el-col",{attrs:{span:6}},[s("div",{staticClass:"grid-content bg-purple"},[s("div",{staticClass:"content-top-right"},[s("img",{attrs:{src:a("9smv"),width:"100%"}}),e._v(" "),s("hr",{staticStyle:{"background-color":"#d3dce6",height:"1px",border:"none"}}),e._v(" "),s("div",{staticClass:"inner-info"},[s("el-row",{staticStyle:{height:"60px"}},[s("el-col",{attrs:{span:6}},[s("img",{staticStyle:{"border-radius":"100px"},attrs:{src:e.getImgBaseUrl+e.good_detail.publisher.picture,width:"60px",height:"60px"}})]),e._v(" "),s("el-col",{staticStyle:{"padding-left":"10px"},attrs:{span:18}},[s("p",{staticClass:"small-text"},[e._v("个人签名：\n                ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v(e._s(e.good_detail.publisher.signature)+"\n                ")])])],1),e._v(" "),s("p",{staticClass:"small-text"},[e._v("卖家    id:\n                  \n              "+e._s(e.good_detail.publisher.id)+"\n            ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("卖家昵称:\n                  \n              "+e._s(e.good_detail.publisher.username)+"\n            ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("卖家等级:\n                  \n              level."+e._s(e.good_detail.publisher.level)+"\n            ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("卖家信用:\n                  \n              "+e._s(e.good_detail.publisher.credit)+"分\n            ")]),e._v(" "),s("p",{staticClass:"small-text"},[e._v("卖家地址:\n                  \n              "+e._s(e.good_detail.publisher.address)+"\n            ")]),e._v(" "),s("div",{staticStyle:{"padding-left":"70px"}},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"给卖家发邮件告诉他你的意向",placement:"top"}},[s("el-button",{attrs:{type:"info",icon:"el-icon-message",size:"mini",circle:""}})],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"和卖家在系统中沟通",placement:"top"}},[s("el-button",{attrs:{type:"info",icon:"el-icon-mobile-phone",size:"mini",circle:""}})],1)],1)],1)])])]):e._e()],1),e._v(" "),s("p",[e._v(" ")]),e._v(" "),s("hr",{staticStyle:{"background-color":"#d3dce6",height:"1px",border:"none"}}),e._v(" "),s("el-container",[s("el-aside",{staticStyle:{"padding-top":"8px"},attrs:{width:"250px"}},[e._v("为你推荐\n      "),s("hr",{staticStyle:{"background-color":"#d3dce6",height:"1px",border:"none"}}),e._v(" "),e._l(e.similar_goods,function(t){return s("div",{key:t.id,staticStyle:{"border-bottom":"1px dashed #d3dce6","margin-bottom":"10px"}},[s("img",{attrs:{width:"150px",src:e.getImgBaseUrl+t.picture[0]},on:{click:function(a){return e.goAnother(t.id)}}}),e._v(" "),s("br"),e._v(" "),s("a",{on:{click:function(a){return e.goAnother(t.id)}}},[e._v(e._s(t.title))]),e._v(" "),s("br")])})],2),e._v(" "),s("el-main",[s("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"产品介绍",name:"first"}},[s("div",{staticClass:"inner-detail-good"},[s("p",{staticStyle:{"border-bottom":"1px dashed #d3dce6","margin-bottom":"10px"}},[e._v("\n              商品名称： "+e._s(e.good_detail.title)+"     \n              换物价： "+e._s(e.good_detail.price)+".00(元)     \n              商品类型： "+e._s(e.good_detail.type)),s("br"),s("br")]),e._v(" "),s("br"),e._v("\n            卖家介绍:     "+e._s(e.good_detail.detail)+"\n            "),s("br"),e._v(" "),s("br"),e._v("\n            详细大图：\n            "),s("br"),e._v(" "),s("br"),e._v(" "),s("div",e._l(e.good_detail.picture,function(t){return s("img",{key:t,staticStyle:{"margin-bottom":"10px"},attrs:{src:e.getImgBaseUrl+t,width:"400px"}})}),0)])]),e._v(" "),s("el-tab-pane",{attrs:{label:"常见问题",name:"second"}})],1)],1)],1)],1)},staticRenderFns:[]};var J=a("VU/8")(W,A,!1,function(e){a("lwV3")},"data-v-c2f6d5d2",null).exports;r.default.use(p.a);var Q=new p.a({mode:"history",routes:[{path:"/home",name:"home",components:{default:$,header:w},meta:{isLogin:!1}},{path:"/goods",name:"goods",components:{default:F,header:w},meta:{isLogin:!0},children:[{path:":id",name:"goodsDetail",component:J,meta:{isLogin:!0}},{path:":id/want",name:"goodsWant",component:O,meta:{isLogin:!0}}]},{path:"/login",name:"login",components:{default:I,header:w},meta:{isLogin:!1}},{path:"/register",name:"register",components:{default:N,header:w},meta:{isLogin:!1}},{path:"/personal",name:"personal",components:{default:H,header:w},meta:{isLogin:!0},children:[{path:"image",name:"personalImage",components:{personal:function(e){return a.e(1).then(function(){var t=[a("MMRs")];e.apply(null,t)}.bind(this)).catch(a.oe)}},meta:{isLogin:!0}},{path:"info",name:"personalInfo",components:{personal:function(e){return a.e(2).then(function(){var t=[a("lBFD")];e.apply(null,t)}.bind(this)).catch(a.oe)}},meta:{isLogin:!0}},{path:"password",name:"personalPassword",components:{personal:function(e){return a.e(0).then(function(){var t=[a("gw6u")];e.apply(null,t)}.bind(this)).catch(a.oe)}},meta:{isLogin:!0}}]},{path:"/publish",name:"publish",components:{default:q,header:w},meta:{isLogin:!0}}]}),Z=a("R4Sj");r.default.use(Z.a);var Y=new Z.a.Store({state:{token:null,base_url:"http://localhost:8000/upload/",userinfo:null},mutations:{changeToken:function(e,t){e.token=t},changeUserinfo:function(e,t){e.userinfo=t}},actions:{setToken:function(e,t){(0,e.commit)("changeToken",t)},setUserinfo:function(e,t){(0,e.commit)("changeUserinfo",t)}}}),K=a("aozt"),X=a.n(K),G=a("CtzY"),ee=a.n(G);r.default.prototype.$qs=ee.a,X.a.defaults.withCredentials=!0,X.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",X.a.defaults.baseURL="http://127.0.0.1:8000",r.default.prototype.$axios=X.a,r.default.use(n.a,{size:"small"}),r.default.config.productionTip=!1;var te=void 0,ae=0;function se(){0===ae&&(te=r.default.prototype.$loading({lock:!0,text:"努力加载中...",background:"rgba(0,0,0,0.5)",target:document.querySelector(".loading-area")})),ae++}function oe(){ae<=0||0===--ae&&te.close()}var re=localStorage.getItem("Token");re&&Y.dispatch("setToken",re),X.a.interceptors.request.use(function(e){return!1!==e.isLoading&&se(),localStorage.Token&&(e.headers.Authorization="Token "+localStorage.Token),e},function(e){return oe(),o.a.reject(e)}),X.a.interceptors.response.use(function(e){return oe(),e},function(e){if(oe(),e.response)switch(e.response.status){case 401:Y.dispatch("setToken",null),Q.replace({path:"/login"})}return o.a.reject(e.response.data)}),Q.beforeEach(function(e,t,a){var s=localStorage.getItem("Token");if(s){var o=Y.state.userinfo;console.log("同步前的userinfo  ",o),null!=o&&o.username||X.a.get("/user/info").then(function(e){var t=e.data;console.log("同步后的userinfo  ",t),Y.dispatch("setUserinfo",t)}),Y.dispatch("setToken",s),a(),e.meta.isLogin||a({path:"/home"})}else Y.dispatch("setUserinfo",{}),e.meta.isLogin?a({path:"/login"}):a()}),Q.afterEach(function(e){}),new r.default({el:"#app",router:Q,store:Y,components:{App:m},template:"<App/>",beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}})},"QJz+":function(e,t){},TDhp:function(e,t){},eMli:function(e,t){},fQBZ:function(e,t){},gQV5:function(e,t){},h5ZX:function(e,t){},lwV3:function(e,t){},pCJT:function(e,t){},qVfH:function(e,t){},s2S0:function(e,t){},t0aP:function(e,t){},xtiH:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.12604749950dc8e3b753.js.map